- name: import tasks
  block:
    - name: make assertions
      import_tasks: "{{ role_path }}/tasks/assertions.yml"

    - name: handle routine
      import_tasks: "{{ role_path }}/tasks/routine.yml"

    - name: end play without successful status when not up to date
      when: not hostvars['localhost'].routine_moodle_status_uptodate | default(true)
      meta: end_play

    - name: include successful status
      import_tasks: "{{ common_path }}/condition/ready/successful.yml"
      delegate_to: localhost
  rescue:
    - name: include rescue tasks
      import_tasks: "{{ common_path }}/rescue.yml"
      delegate_to: localhost
